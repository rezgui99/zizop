{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators, ReactiveFormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nlet EmployeeSkillsComponent = class EmployeeSkillsComponent {\n  constructor(skillService, employeeService, skillMetaService, fb) {\n    this.skillService = skillService;\n    this.employeeService = employeeService;\n    this.skillMetaService = skillMetaService;\n    this.fb = fb;\n    this.skills = [];\n    this.employees = [];\n    this.skillsList = [];\n    this.skillLevels = [];\n    this.showAddForm = false;\n    this.editingSkill = null;\n    this.loading = false;\n    this.errorMessage = null;\n    this.skillForm = this.fb.group({\n      employee_id: ['', Validators.required],\n      skill_id: ['', Validators.required],\n      actual_skill_level_id: ['', Validators.required],\n      acquired_date: ['', Validators.required],\n      certification: [''],\n      last_evaluated_date: ['']\n    });\n  }\n  ngOnInit() {\n    this.loadSkills();\n    this.loadEmployees();\n    this.loadSkillList();\n    this.loadSkillLevels();\n  }\n  loadSkills() {\n    this.loading = true;\n    this.errorMessage = null;\n    this.skillService.getAll().subscribe({\n      next: data => {\n        this.skills = data;\n        this.loading = false;\n      },\n      error: err => {\n        this.errorMessage = err?.message || 'Erreur lors du chargement';\n        this.loading = false;\n      }\n    });\n  }\n  loadEmployees() {\n    this.employeeService.getEmployees().subscribe({\n      next: data => this.employees = data,\n      error: err => console.error(err)\n    });\n  }\n  loadSkillList() {\n    this.skillMetaService.getSkills().subscribe({\n      next: data => this.skillsList = data,\n      error: err => console.error(err)\n    });\n  }\n  loadSkillLevels() {\n    this.skillMetaService.getSkillLevels().subscribe({\n      next: data => this.skillLevels = data,\n      error: err => console.error(err)\n    });\n  }\n  onSubmit() {\n    if (!this.skillForm.valid) return;\n    const skillData = this.skillForm.value;\n    if (this.editingSkill) {\n      this.skillService.update(this.editingSkill.employee_id, this.editingSkill.skill_id, skillData).subscribe({\n        next: updatedSkill => {\n          const index = this.skills.findIndex(s => s.employee_id === updatedSkill.employee_id && s.skill_id === updatedSkill.skill_id);\n          if (index !== -1) this.skills[index] = updatedSkill;\n          this.cancelEdit();\n        },\n        error: err => this.errorMessage = err?.message || 'Erreur lors de la mise à jour'\n      });\n    } else {\n      this.skillService.create(skillData).subscribe({\n        next: newSkill => {\n          this.skills.push(newSkill);\n          this.cancelEdit();\n        },\n        error: err => this.errorMessage = err?.message || 'Erreur lors de l\\'ajout'\n      });\n    }\n  }\n  editSkill(skill) {\n    this.editingSkill = skill;\n    this.showAddForm = true;\n    this.skillForm.patchValue({\n      employee_id: skill.employee_id,\n      skill_id: skill.skill_id,\n      actual_skill_level_id: skill.actual_skill_level_id,\n      acquired_date: skill.acquired_date,\n      certification: skill.certification,\n      last_evaluated_date: skill.last_evaluated_date\n    });\n  }\n  deleteSkill(skill) {\n    if (!confirm('Voulez-vous vraiment supprimer cette compétence ?')) return;\n    this.skillService.delete(skill.employee_id, skill.skill_id).subscribe({\n      next: () => this.skills = this.skills.filter(s => !(s.employee_id === skill.employee_id && s.skill_id === skill.skill_id)),\n      error: err => this.errorMessage = err?.message || 'Erreur lors de la suppression'\n    });\n  }\n  cancelEdit() {\n    this.editingSkill = null;\n    this.showAddForm = false;\n    this.skillForm.reset();\n  }\n};\nEmployeeSkillsComponent = __decorate([Component({\n  selector: 'app-employee-skills',\n  standalone: true,\n  imports: [CommonModule, ReactiveFormsModule],\n  templateUrl: './employee-skills.component.html',\n  styleUrls: ['./employee-skills.component.css']\n})], EmployeeSkillsComponent);\nexport { EmployeeSkillsComponent };","map":{"version":3,"names":["Component","Validators","ReactiveFormsModule","CommonModule","EmployeeSkillsComponent","constructor","skillService","employeeService","skillMetaService","fb","skills","employees","skillsList","skillLevels","showAddForm","editingSkill","loading","errorMessage","skillForm","group","employee_id","required","skill_id","actual_skill_level_id","acquired_date","certification","last_evaluated_date","ngOnInit","loadSkills","loadEmployees","loadSkillList","loadSkillLevels","getAll","subscribe","next","data","error","err","message","getEmployees","console","getSkills","getSkillLevels","onSubmit","valid","skillData","value","update","updatedSkill","index","findIndex","s","cancelEdit","create","newSkill","push","editSkill","skill","patchValue","deleteSkill","confirm","delete","filter","reset","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\h_ref\\Desktop\\frontend\\matchnhire\\src\\app\\pages\\employee-skills\\employee-skills.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { EmployeeSkillService } from '../../services/employee-skill.service';\r\nimport { EmployeeService, Employee } from '../../services/employee.service';\r\nimport { SkillService, Skill, SkillLevel } from '../../services/skill.service';\r\nimport { EmployeeSkill } from '../../models/employee-skill.model';\r\n\r\n@Component({\r\n  selector: 'app-employee-skills',\r\n  standalone: true,\r\n  imports: [CommonModule, ReactiveFormsModule],\r\n  templateUrl: './employee-skills.component.html',\r\n  styleUrls: ['./employee-skills.component.css']\r\n})\r\nexport class EmployeeSkillsComponent implements OnInit {\r\n  skills: EmployeeSkill[] = [];\r\n  employees: Employee[] = [];\r\n  skillsList: Skill[] = [];\r\n  skillLevels: SkillLevel[] = [];\r\n  skillForm: FormGroup;\r\n  showAddForm: boolean = false;\r\n  editingSkill: EmployeeSkill | null = null;\r\n  loading: boolean = false;\r\n  errorMessage: string | null = null;\r\n\r\n  constructor(\r\n    private skillService: EmployeeSkillService,\r\n    private employeeService: EmployeeService,\r\n    private skillMetaService: SkillService,\r\n    private fb: FormBuilder\r\n  ) {\r\n    this.skillForm = this.fb.group({\r\n      employee_id: ['', Validators.required],\r\n      skill_id: ['', Validators.required],\r\n      actual_skill_level_id: ['', Validators.required],\r\n      acquired_date: ['', Validators.required],\r\n      certification: [''],\r\n      last_evaluated_date: ['']\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.loadSkills();\r\n    this.loadEmployees();\r\n    this.loadSkillList();\r\n    this.loadSkillLevels();\r\n  }\r\n\r\n  loadSkills(): void {\r\n    this.loading = true;\r\n    this.errorMessage = null;\r\n    this.skillService.getAll().subscribe({\r\n      next: (data: EmployeeSkill[]) => {\r\n        this.skills = data;\r\n        this.loading = false;\r\n      },\r\n      error: (err: any) => {\r\n        this.errorMessage = err?.message || 'Erreur lors du chargement';\r\n        this.loading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  loadEmployees(): void {\r\n    this.employeeService.getEmployees().subscribe({\r\n      next: (data: Employee[]) => this.employees = data,\r\n      error: (err: any) => console.error(err)\r\n    });\r\n  }\r\n\r\n  loadSkillList(): void {\r\n    this.skillMetaService.getSkills().subscribe({\r\n      next: (data: Skill[]) => this.skillsList = data,\r\n      error: (err: any) => console.error(err)\r\n    });\r\n  }\r\n\r\n  loadSkillLevels(): void {\r\n    this.skillMetaService.getSkillLevels().subscribe({\r\n      next: (data: SkillLevel[]) => this.skillLevels = data,\r\n      error: (err: any) => console.error(err)\r\n    });\r\n  }\r\n\r\n  onSubmit(): void {\r\n    if (!this.skillForm.valid) return;\r\n    const skillData: EmployeeSkill = this.skillForm.value;\r\n\r\n    if (this.editingSkill) {\r\n      this.skillService.update(this.editingSkill.employee_id, this.editingSkill.skill_id, skillData)\r\n        .subscribe({\r\n          next: (updatedSkill: EmployeeSkill) => {\r\n            const index = this.skills.findIndex(s =>\r\n              s.employee_id === updatedSkill.employee_id &&\r\n              s.skill_id === updatedSkill.skill_id\r\n            );\r\n            if (index !== -1) this.skills[index] = updatedSkill;\r\n            this.cancelEdit();\r\n          },\r\n          error: (err: any) => this.errorMessage = err?.message || 'Erreur lors de la mise à jour'\r\n        });\r\n    } else {\r\n      this.skillService.create(skillData)\r\n        .subscribe({\r\n          next: (newSkill: EmployeeSkill) => {\r\n            this.skills.push(newSkill);\r\n            this.cancelEdit();\r\n          },\r\n          error: (err: any) => this.errorMessage = err?.message || 'Erreur lors de l\\'ajout'\r\n        });\r\n    }\r\n  }\r\n\r\n  editSkill(skill: EmployeeSkill): void {\r\n    this.editingSkill = skill;\r\n    this.showAddForm = true;\r\n    this.skillForm.patchValue({\r\n      employee_id: skill.employee_id,\r\n      skill_id: skill.skill_id,\r\n      actual_skill_level_id: skill.actual_skill_level_id,\r\n      acquired_date: skill.acquired_date,\r\n      certification: skill.certification,\r\n      last_evaluated_date: skill.last_evaluated_date\r\n    });\r\n  }\r\n\r\n  deleteSkill(skill: EmployeeSkill): void {\r\n    if (!confirm('Voulez-vous vraiment supprimer cette compétence ?')) return;\r\n\r\n    this.skillService.delete(skill.employee_id, skill.skill_id)\r\n      .subscribe({\r\n        next: () => this.skills = this.skills.filter(s =>\r\n          !(s.employee_id === skill.employee_id && s.skill_id === skill.skill_id)\r\n        ),\r\n        error: (err: any) => this.errorMessage = err?.message || 'Erreur lors de la suppression'\r\n      });\r\n  }\r\n\r\n  cancelEdit(): void {\r\n    this.editingSkill = null;\r\n    this.showAddForm = false;\r\n    this.skillForm.reset();\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}